<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />    
        <link href="../$settings.CssShortFileName" rel="stylesheet" type="text/css" />
        <title>Accipio Test Run Report ($settings.ProjectName)</title>
    </head>
    <body>
        <div class="ReportHeader">
            <h1>Accipio Test Run Report</h1>
            <p class="AccipioVersion">Accipio $accipioVersion</p>
            <p class="HeaderData">Project: $settings.ProjectName (<a href="../TestRunsHistory.htm">view the whole test history</a>)</p>
            <p class="HeaderData">Start time: $testRun.StartTime</p>
            <p class="HeaderData">End time: $testRun.EndTime</p>
            <p class="HeaderData">Duration: $testRun.DurationString</p>
        </div>
        <div class="SectionDiv">
            <h2>User Stories</h2>
            <table class="SectionTable">
                <tr class="SectionTableHeader">
                    <th align="left">User story ID</th>
                    <th>Tests sucessful</th>
                    <th>Tests failed</th>
                    <th>Tests not implemented</th>
                    <th>Status</th>
                </tr>
                #foreach ( $userStoryRun in $testRun.ListUserStoriesRuns() )
                    #if ($userStoryRun.Status == "Successful")
                <tr class="TableRowSuccess">
                    #elseif  ($userStoryRun.Status == "Failed")
                <tr class="TableRowFailed">
                    #else
                <tr class="TableRowTodo">
                    #end
                    
                    <td align="left">$userStoryRun.UserStoryId</td>
                    <td align="center">$userStoryRun.TestCasesSuccess</td>
                    <td align="center">$userStoryRun.TestCasesFail</td>
                    <td align="center">$userStoryRun.TestCasesNotImplemented</td>
                    <td align="center">$userStoryRun.Status</td>
                </tr>
                #end
                <tr class="SectionTableRowTotals">
                    <td align="left">Total</td>
                    <td align="center">$testRun.TestCasesSuccess</td>
                    <td align="center">$testRun.TestCasesFail</td>
                    <td align="center">$testRun.TestCasesNotImplemented</td>
                    <td></td>
                </tr>
            </table>
        </div>
        <div class="SectionDiv">
            <h2>Test Suites</h2>
            <table class="SectionTable">
                <tr class="SectionTableHeader">
                    <th align="left">Test suite ID</th>
                    <th>Tests passed</th>
                    <th>Tests failed</th>
                    <th>Tests not implemented</th>
                    <th>Status</th>
                </tr>
                #foreach ( $testSuiteRun in $testRun.ListTestSuitesRuns() )
                    #if ($testSuiteRun.Status == "Successful")
                <tr class="TableRowSuccess">
                    #elseif ($testSuiteRun.Status == "Failed")
                <tr class="TableRowFailed">
                    #else
                <tr class="TableRowTodo">
                    #end
                    <td align="left">$testSuiteRun.TestSuiteId</td>
                    <td align="center">$testSuiteRun.TestCasesSuccess</td>
                    <td align="center">$testSuiteRun.TestCasesFail</td>
                    <td align="center">$testSuiteRun.TestCasesNotImplemented</td>
                    <td align="center">$testSuiteRun.Status</td>
                </tr>
                #end
            </table>         
        </div>    
            <div class="Section2Div">
                #foreach ( $testSuiteRun in $testRun.ListTestSuitesRuns() )
                <h3>Test Suite $testSuiteRun.TestSuiteId</h3> 

                <table class="SectionTable">
                    <tr class="SectionTableHeader">
                        <th align="left">Test case ID</th>
                        <th>Status</th>
                        <th>Error message</th>
                        <th>Duration (s)</th>
                    </tr>
                    #foreach ( $testCaseRun in $testSuiteRun.ListTestCasesRuns() )
                        #if ($testCaseRun.Status == "Successful")
                    <tr class="TableRowSuccess">
                        #elseif ($testCaseRun.Status == "Failed")
                    <tr class="TableRowFailed">
                        #else
                    <tr class="TableRowTodo">
                        #end                    
                        <td align="left">$testCaseRun.TestCaseId</td>
                        <td>$testCaseRun.Status</td>
                        <td>$!testCaseRun.Message</td>
                        <td>$!testCaseRun.Duration.TotalSeconds.ToString("n1")</td>
                    </tr>       
                    #end         
                </table>            
                #end
            </div>
        </div>
    </body>
</html>